module-hiro
  div.wrap-module
    div.bg
      div.bg-sp.f.fh.s-show
        img(src='./movie/demo_sp.gif')#hiroBgSp
      div.bg-pc.f.fh.s-hide
        //video(src='./movie/hiro.mp4' loop autoplay)
        img(src='./movie/demo.gif')#hiroBg
    div.overlay
    div.wrap-hiro-content.f.fh
      div.wrap-title.pt20
        p.logo Bot Editor
        p.tagline.mb80 Editing bot script made super easy
        div.f.fc
          atom-button-registor(label='事前登録する')


  style(scoped, type='less').
    :scope {
      display: block;
      width: 100%;
      /*height: 60vh;*/
      background: #f5f5f5;
      /*transition: all 0.1s;*/
      .wrap-module {
        position: relative;
        width: 100%;
        height: 100%;
        .bg {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          z-index: 1;
          .bg-pc {
            video {
              min-height: 100vh;
            }
          }
        }
        .overlay {
          display: block;
          position: absolute;
          left: 0;
          top: 0;
          width: 100%;
          height: 100%;
          background: rgba(0,0,0,0.3);
          z-index: 2;
        }
        .wrap-hiro-content {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          z-index: 3;
          .wrap-title {
            p {
              color: #fff;
              text-align: center;
            }
            .logo {
              font-size: 46px;
              font-weight: 500;
              letter-spacing: 3.6px;
            }
            .tagline {
              font-size: 14px;
              font-weight: 100;
              letter-spacing: 0.4px;
            }
          }
        }
      }

      @media only screen and (max-width : 600px) {
        .tagline {
          margin-bottom: 40px;
        }
      }
    }


  script.

    var self = this;

    this.on('mount', function(){
      
      var timer = 0;
 
      // リサイズ時に一度だけ発火させる関数
      window.onresize = function () {
        if (timer > 0) {
          clearTimeout(timer);
        }
       
        timer = setTimeout(function () {
          var body = document.querySelector('body')
          if(body.offsetWidth > 600){
            var bg = document.getElementById('hiroBg');
            var h = bg.height;
            console.log(h);

            var hiro = document.querySelector('module-hiro');
            hiro.style.height = `${h}px`;
          }else{
            var bg = document.getElementById('hiroBgSp');
            var h = bg.height;
            console.log(h);
            var hiro = document.querySelector('module-hiro');
            hiro.style.height = `${h}px`;
          }
        }, 200);
      };
 

      riot.gifLoadedTimer = setInterval(function(){ 
        console.log('timer');
        var body = document.querySelector('body');
        var bg = document.getElementById('hiroBg');
        var bg_sp = document.getElementById('hiroBgSp');

        if(body.offsetWidth > 600){
          
          var h = bg.height;
          var hiro = document.querySelector('module-hiro');
          hiro.style.height = `${h}px`;

          if(h > 0){
            gifIsLoaded = true;
            $('util-loading').fadeOut(400);
            clearInterval(riot.gifLoadedTimer);
          }
        }else{
          
          var h = bg_sp.height;
          var hiro = document.querySelector('module-hiro');
          hiro.style.height = `${h}px`;

          if(h > 0){
            gifIsLoaded = true;
            $('util-loading').fadeOut(400);
            clearInterval(riot.gifLoadedTimer);
          }
        }

    
      }, 400);

      /*
      setTimeout(function () {
        var body = document.querySelector('body')
        if(body.offsetWidth > 600){
          var bg = document.getElementById('hiroBg');
          var h = bg.height;
          var hiro = document.querySelector('module-hiro');
          hiro.style.height = `${h}px`;
        }else{
          var bg = document.getElementById('hiroBgSp');
          var h = bg.height;
          console.log(h);
          var hiro = document.querySelector('module-hiro');
          hiro.style.height = `${h}px`;
        }
      },400);
      */

    });
    





    